<div class="form-wrapper">
    <form nz-form [formGroup]="customSearchForm" [nzLayout]="'inline'" class="ant-advanced-search-form">
        <div nz-row [nzGutter]="24" class="row-control">
            <div nz-col [nzSpan]="6">
                <nz-form-item class="search-form-item">
                    <nz-form-label>客户名称</nz-form-label>
                    <nz-form-control nzErrorTip="请输入客户名称!">
                        <input type="text" nz-input formControlName="cusName" placeholder="请输入客户名称" />
                    </nz-form-control>
                </nz-form-item>
            </div>
            <div nz-col [nzSpan]="6">
                <nz-form-item>
                    <nz-form-label>性别</nz-form-label>
                    <nz-form-control nzErrorTip="请输入性别!">
                        <nz-select formControlName="gender" nzAllowClear nzPlaceHolder="请选择性别">
                            <nz-option *ngFor="let option of optionList" [nzValue]="option.value"
                                [nzLabel]="option.label">
                            </nz-option>
                        </nz-select>
                    </nz-form-control>
                </nz-form-item>
            </div>
            <div nz-col [nzSpan]="6">
                <nz-form-item>
                    <nz-form-label>手机号</nz-form-label>
                    <nz-form-control nzErrorTip="请输入手机号!">
                        <input type="text" nz-input formControlName="telPhone" placeholder="请输入手机号" />
                    </nz-form-control>
                </nz-form-item>
            </div>
        </div>
        <div nz-row>
            <div nz-col [nzSpan]="24" class="search-area">
                <button nz-button [nzType]="'primary'" (click)="search()">查询</button>
                <button nz-button (click)="resetForm()">清空</button>
                <a class="collapse" (click)="isCollapse=!isCollapse">
                    {{isCollapse ? '收起' : '展开'}}
                    <i nz-icon [nzType]="isCollapse ? 'up' : 'down'"></i>
                </a>
            </div>

        </div>
    </form>
</div>
<button nz-button nzType="primary" class="reflesh-button" (click)='refleshData()'>
    <i nz-icon nzType="sync"></i></button>
<button nz-button nzType="primary" class="add-button" (click)='showAddModal()'>新增</button>


<!-- 客户列表 -->
<nz-table #basicTable [nzData]="listOfData" [nzBordered]=true  [nzPageSize]=5
    (nzCurrentPageDataChange)="onCurrentPageDataChange($event)" nzTableLayout="fixed">
    <thead>
        <tr>
            <th nzWidth="50px" [(nzChecked)]="checked" [nzIndeterminate]="indeterminate"
                (nzCheckedChange)="onAllChecked($event)"></th>
            <th nzWidth="70px">序号</th>
            <th>客户名称</th>
            <th>性别</th>
            <th>手机号</th>
            <th>创建时间</th>
            <th>操作</th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let data of basicTable.data ; let i = index ;  ">
            <td [nzChecked]="setOfCheckedId.has(data.id)" (nzCheckedChange)="onItemChecked(data.id, $event)"></td>
            <td>{{ i+1 }}</td>
            <td>{{ data.cusName }}</td>
            <td>{{ data.gender==0 ? '男':'女' }}</td>
            <td>{{ data.telPhone }}</td>
            <td>{{ data.createTime | date: 'yyyy-MM-dd hh:mm:ss' }}</td>
            <td>
                <a (click)="showInfoModal(data.id)">详情</a>
                <nz-divider nzType="vertical"></nz-divider>
                <a (click)="showEditModal(data.id)">修改</a>
                <nz-divider nzType="vertical"></nz-divider>
                <a nz-popconfirm nzPopconfirmTitle="是否确认删除?" (nzOnConfirm)="delConfirm(data.id)"
                    (nzOnCancel)="delCancel()" nzPopconfirmPlacement="bottomRight">删除</a>
            </td>
        </tr>
    </tbody>
</nz-table>

<!-- 客户详情 -->
<nz-modal [(nzVisible)]="isShowInfoCustomModel" nzTitle="客户详情" [nzFooter]=null (nzOnCancel)="handleInfoCustomCancel()">
    <form nz-form [formGroup]="customForm">
        <!-- 昵称 -->
        <nz-form-item>
            <nz-form-label [nzSpan]="6" nzRequired>客户名称</nz-form-label>
            <nz-form-control [nzSpan]="12" nzHasFeedback nzValidatingTip="Validating...">
                <input nz-input formControlName="cusName" />
            </nz-form-control>
        </nz-form-item>
        <!-- 性别 -->
        <nz-form-item>
            <nz-form-label [nzSpan]="6" nzRequired>性别</nz-form-label>
            <nz-form-control [nzSpan]="12">
                <nz-radio-group formControlName="gender">
                    <label nz-radio [nzValue]="o.value" *ngFor="let o of optionList">{{ o.label }}</label>
                </nz-radio-group>
            </nz-form-control>
        </nz-form-item>
        <!-- 手机号 -->
        <nz-form-item>
            <nz-form-label [nzSpan]="6">手机号</nz-form-label>
            <nz-form-control [nzSpan]="12">
                <input nz-input formControlName="telPhone" />
            </nz-form-control>
        </nz-form-item>
    </form>
</nz-modal>

<!-- 客户编辑 -->
<nz-modal [(nzVisible)]="isShowEditCustomModel" nzTitle="客户编辑" (nzOnCancel)="handleEditCustomCancel()"
    (nzOnOk)="handleEditPositionOk($event,customForm.value)">
    <form nz-form [formGroup]="customForm">
        <!-- 昵称 -->
        <nz-form-item>
            <nz-form-label [nzSpan]="6" nzRequired>客户名称</nz-form-label>
            <nz-form-control [nzSpan]="12" nzHasFeedback nzValidatingTip="Validating..." [nzErrorTip]="cusNameErrorTpl">
                <input nz-input formControlName="cusName" />
                <ng-template #cusNameErrorTpl let-control>
                    <ng-container *ngIf="control.hasError('required')">客户名称不能为空</ng-container>
                </ng-template>
            </nz-form-control>
        </nz-form-item>
        <!-- 性别 -->
        <nz-form-item>
            <nz-form-label [nzSpan]="6" nzRequired>性别</nz-form-label>
            <nz-form-control [nzSpan]="12" nzHasFeedback nzValidatingTip="Validating..." [nzErrorTip]="genderErrorTpl">
                <nz-radio-group formControlName="gender">
                    <label nz-radio [nzValue]="o.value" *ngFor="let o of optionList">{{ o.label }}</label>
                </nz-radio-group>
                <ng-template #genderErrorTpl let-control>
                    <ng-container *ngIf="control.hasError('required')">昵称不能为空</ng-container>
                </ng-template>
            </nz-form-control>
        </nz-form-item>
        <!-- 手机号 -->
        <nz-form-item>
            <nz-form-label [nzSpan]="6">手机号</nz-form-label>
            <nz-form-control [nzSpan]="12">
                <input nz-input formControlName="telPhone" />
            </nz-form-control>
        </nz-form-item>
    </form>
</nz-modal>

<!-- 客户新增 -->
<nz-modal [(nzVisible)]="isShowAddCustomModel" nzTitle="客户新增" (nzOnCancel)="handleAddCustomCancel()"
  (nzOnOk)="handleAddCustomOk($event,customAddForm.value)">
  <form nz-form [formGroup]="customAddForm">
    <!-- 昵称 -->
    <nz-form-item>
      <nz-form-label [nzSpan]="6" nzRequired>客户名称</nz-form-label>
      <nz-form-control [nzSpan]="12" nzHasFeedback nzValidatingTip="Validating..." [nzErrorTip]="cusNameErrorTpl">
        <input nz-input formControlName="cusName" />
        <ng-template #cusNameErrorTpl let-control>
          <ng-container *ngIf="control.hasError('required')">客户名称不能为空</ng-container>
        </ng-template>
      </nz-form-control>
    </nz-form-item>
    <!-- 性别 -->
    <nz-form-item>
      <nz-form-label [nzSpan]="6" nzRequired>性别</nz-form-label>
      <nz-form-control [nzSpan]="12" nzHasFeedback>
        <nz-radio-group formControlName="gender">
          <label nz-radio nzValue="0">男</label>
          <label nz-radio nzValue="1">女</label>
        </nz-radio-group>
      </nz-form-control>
    </nz-form-item>
    <!-- 手机号 -->
    <nz-form-item>
      <nz-form-label [nzSpan]="6">手机号</nz-form-label>
      <nz-form-control [nzSpan]="12">
        <input nz-input formControlName="telPhone" />
      </nz-form-control>
    </nz-form-item>
  </form>
</nz-modal>